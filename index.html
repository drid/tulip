<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="node_modules/foundation-sites/css/foundation.min.css" />
    <link rel="stylesheet" href="node_modules/foundation-icons/foundation-icons.css" />
    <link rel="stylesheet" type="text/css" href="assets/css/common.css">
    <link rel="stylesheet" type="text/css" href="assets/css/tulip.css">
    <link rel="stylesheet" type="text/css" href="node_modules/quill/dist/quill.snow.css">
  </head>
  <body class="off-canvas-wrap" data-offcanvas>
    <img id="loading" src="./assets/tulip-logo3.png" style="width:300px">
    <!-- top navigation tools -->
    <main class="inner-wrap" style="height:100%">
    <!-- START NAV -->
    <nav class="top-bar" data-topbar role="navigation">
      <!-- map Section -->
      <ul class="left">
        <li>
          <a href="#" class="button tiny radius secondary" id="zin"><i class="fi-plus"></i></a>
          <a href="#" class="button tiny radius secondary" id="zout"><i class="fi-minus"></i></a>
        </li>
      </ul>
      <ul class="left">
        <li>
          <a href="#" class="button dropdown tiny radius secondary" data-dropdown="layers-dropdown" aria-controls="drop1" aria-expanded="false" id="map-layers">
            <i class="fi-map"></i>
          </a>
          <ul id="layers-dropdown" data-dropdown-content class="f-dropdown" aria-hidden="true">
            <li><a href="#" id="map-hybrid-layer" class="selected" >Hybrid <i class="fi-check"></i></a></li>
            <li><a href="#" id="map-satellite-layer">Satellite <i class="fi-check hide"></i></a></li>
            <li><a href="#" id="map-roadmap-layer">Roadmap <i class="fi-check hide"></i></a></li>
            <li><a href="#" id="map-terrain-layer">Terrain <i class="fi-check hide"></i></a></li>
          </ul>
        </li>
      </ul>
      <ul class="left">
        <li>
          <span data-tooltip aria-haspopup="true" class="map-rotate-notice has-tip button tiny radius alert" style="display: none;" title="Map interaction other than zoom is disabled when map is rotated.">
            <i class="fi-alert"></i>
          </span>
          <a href="#" class="button tiny radius secondary" id="draw-route" data-tooltip aria-haspopup="true" title="When enabled prevents adding points on map click">
            <i class="fi-lock"></i>
          </a>
          <!-- maybe reourpose for snap to -->
          <!-- <a href="#" class="button tiny radius secondary" id="remove-route" data-tooltip aria-haspopup="true" title="When enabled clicking on one point then another removes all points in between.">
            <i class="fi-x-circle"></i>
          </a> -->
        </li>
      </ul>
    </nav>
    <!-- END NAV -->
    <!--  START SETTINGS MENU -->
    <aside class="right-off-canvas-menu">
        <h2>
          Settings:
        </h2>
        <ul>
          <h4>Application Settings</h4>
          <li>Google Maps API key<input type="text" id="gmap_key" class="settings-text"/></li>
          <li>Google Directions API key<input type="text" id="google_directions_key" class="settings-text"/>
          <a href="https://developers.google.com/maps/documentation/embed/get-api-key" target="_blank">API keys help</a></li>
          <li><input type="checkbox" id="open_last"/>Open last roadbook</li>
          <li>User glyph path: <input type="button" id="user_glyph_path_select" class="settings-text" value="..."/>
            <p id="user_glyph_path_text">-</p></li>
          <hr>
          <h4>Tulip settings</h4>
          <li>Tulip close distance (m)<input type="text" id="tulip_near_distance" class="settings-text"/></li>
          <li><input type="checkbox" id="show_cap_heading"/>Show CAP heading (new)</li>
          <li><input type="checkbox" id="show_coordinates"/>Show coordinates (new)</li>
          <li>Coordinates Format<select id="coordinates_format">
            <option value="dd">DD.DDDDD</option>
            <option value="ddmm">DD MM.MMM</option>
            <option value="ddmmss">DD MM SS.SSS</option>
          </select></li>
          <li><input type="checkbox" id="openrally_strict"/>Openrally strict export</li>
          <h4>Map settings</h4>
          <li>Set current view as home<br><input type="button" id="set-current-view-as-home" value="Set"/></li>
          <h4>Debug settings</h4>
          <li><input type="checkbox" id="open_dev_console"/>Dev console on start</li>
          
          <li><input type="button" id="save-settings" value="Save settings"/></li>
        </ul>
    </aside>
    <!--  END SETTINGS MENU -->
    <!--  START CONTENT -->
    <div id="content">
      <div class="content-container">
        <!-- <div class='map-container column' > -->
          <div id="map">
          </div>
        <!-- </div> -->
        <div class='roadbook-container collapsed'>
          <div class="row" id="roadbook-header">
            <div class="large-3 columns title">
              Tulip
            </div>
            <div class="large-5 columns menu">
              <a href="#" class="button tiny radius" data-bind="css: { secondary: app.roadbookController.isSaved }" id="save-roadbook" data-tooltip aria-haspopup="true" class="has-tip button tiny radius alert" title="Click to save. Shift+click to 'Save as'">
                <i class="fi-save"></i>
              </a>
              <a href="#" class="button tiny radius secondary" id="toggle-roadbook"><i class="fi-arrow-down"></i></a>
              <a href="#" class="button tiny radius secondary right-off-canvas-toggle" id="main-menu"><i class="fi-list"></i></a>
            </div>
          </div>
          <div id="roadbook">
            <div class="row roadbook-info">
              <div class="roadbook-logo" class="large-12 columns" data-bind="visible: app.roadbook.customLogo()">
                <img id="roadbook-logo" src="" data-bind="attr: { src: app.roadbook.customLogo() }">
                <i id="roadbook-logo-remove" class="fi-trash"></i>
              </div>
              <div id="roadbook-name" class="large-12 columns">
                <p data-bind="text: app.roadbook.name, event: { blur: app.roadbook.updateName }" contenteditable="true"></p>
              </div>
              <div id="roadbook-details">
                <div class="large-3 column header-route-info">
                  <div id="roadbook-total-distance" class="">
                    Total distance
                    <p data-bind="text: app.roadbook.totalDistance() + 'km'"></p>
                  </div>
                  <div id="roadbook-total-waypoints" class="">
                    Waypoints
                    <div data-bind="text: app.roadbook.instructions().length"></div>
                  </div>
                  <div id="roadbook-fuel-range" class="">
                    Fuel Range
                    <div data-bind="text: app.roadbook.fuelRange() + ' km'"></div>
                  </div>
                </div>
                <div id="roadbook-desc" class="large-9 column">
                  <a href=# class="button tiny radius secondary show-editor rb-desc"><i class="fi-pencil"></i></a>
                  <p data-bind="html: app.roadbook.desc"></p>
                  <div class="roadbook-header-input-container">
                    <div id="description-editor"></div>
                  </div>
                  <a class="button tiny round alert hide-editor rb-desc" title="Hide editor."><i class="fi-x"></i></a>
                </div>
              </div>
            </div>
            <!-- render instruction templates here -->
            <div id="roadbook-waypoints" data-bind="template: { name: 'waypoint-template', foreach: app.roadbook.instructions }"></div>
            <!--  palette for editing instruction content -->
            <div id="waypoint-palette">
              <div class="row">
                <div class="tulip-edit-controls large-12 columns text-right">
                  <a id="draw-freehand" class="button_round" title="Draw" data-bind="click: toggleDrawing, css: isDrawing() ? 'draw-btn-active' : 'draw-btn-inactive'"><i class="fa-solid fa-pencil"></i></a>
                  <a id="rotate-km-marker" class="button_round" title="Rotate km marker"><i class="fa-solid fa-map-pin"></i></a>
                  <a id="delete-tulip-item" class="button_round" title="Delete Glyph"><i class="fi-trash"></i></a>
                  <span data-tooltip aria-haspopup="true" class="has-tip button tiny radius warning map-rotate-notice" style="display: none;" title="Map interaction other than zoom is disabled when map is rotated.">
                    <i class="fi-alert"></i>
                  </span>
                  <a id="orient-map" class="button_round" title="Orient map with tulip"><i class="fi-compass"></i></a>
                  <a id="hide-palette" class="button_round" title="Hide palette."><i class="fi-check"></i></a>
                </div>
              </div>
              <div id="waypoint-tulip-controls" class="content active">
                <div class="row">
                  <div class="large-4 columns selection-label">
                    <h5>
                      <span data-tooltip aria-haspopup="true" class="has-tip track-selection" title="Select the type of tracks added to the tulip, the track type the rider will enter the tulip on, and the track type the rider will exit the tulip on.">
                        Tulip track types
                      </span>
                    </h5>
                  </div>
                  <div class="large-4 columns selection-label">
                    <h5>
                      <span data-tooltip aria-haspopup="true" class="has-tip" title="Insert tracks and glyphs into the tulip using the placement grid.">
                        Insert into tulip
                      </span>
                    </h5>
                    <div class="row">
                      <div class="large-6 columns">
                        <span data-tooltip aria-haspopup="true" class="has-tip" title="Click to add tracks to the tulip radiating from the center in the selected direction using the placement grid.">
                          Tracks
                        </span>
                      </div>
                      <div class="large-6 columns">
                        <div class="switch round tiny">
                          <input id="toggle-insert-track" type="radio" checked name="toggle-insert-type">
                          <label for="toggle-insert-track"></label>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="large-6 columns">
                        <span data-tooltip aria-haspopup="true" class="has-tip" title="Click to add glyphs to the tulip in the selected position using the placement grid.">
                          Glyphs
                        </span>
                      </div>
                      <div class="large-6 columns">
                        <div class="switch round tiny">
                          <input id="toggle-insert-glyph" type="radio" name="toggle-insert-type">
                          <label for="toggle-insert-glyph"></label>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="large-6 columns">
                        <span data-tooltip aria-haspopup="true" class="has-tip" title="Click to add text to the tulip in the selected position using the placement grid.">
                          Text
                        </span>
                      </div>
                      <div class="large-6 columns">
                        <div class="switch round tiny">
                          <input id="toggle-insert-text" type="radio" name="toggle-insert-type">
                          <label for="toggle-insert-text"></label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="large-4 column selection-label">
                    <h5>
                      <span data-tooltip aria-haspopup="true" class="has-tip" title="Insert glyphs into the note and modify glyphs and text using the buttons and slider">
                        Waypoint notes
                      </span>
                    </h5>
                    <div class="row">
                      <div class="large-6 columns">
                        <span data-tooltip aria-haspopup="true" class="has-tip" title="Click to add show or hide the CAP heading for this instruction">
                          CAP
                        </span>
                      </div>
                      <div class="large-6 columns">
                        <div class="switch round tiny">
                          <input id="toggle-heading" type="checkbox" name="toggle-heading" data-bind="checked: instructionShowHeading">
                          <label for="toggle-heading"></label>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="large-6 columns">
                        <span data-tooltip aria-haspopup="true" class="has-tip" title="Click to show or hide the coordinates for this instruction">
                          Lat/Lon
                        </span>
                      </div>
                      <div class="large-6 columns">
                        <div class="switch round tiny">
                          <input id="toggle-coordinates" type="checkbox" name="toggle-coordinates" data-bind="checked: instructionShowCoordinates">
                          <label for="toggle-coordinates"></label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <hr>
                </div>
                <div class="row">
                  <div class="large-4 columns">
                    <ul class="accordion track-selection" data-accordion>
                      <li class="accordion-navigation">
                        <a href="#added-track-tab" class='track-tab-title'>Add as</a>
                        <div id="added-track-tab" class="content active">
                          <a title="Low visible track" href="#" class="button tiny radius secondary added-track-selector" data-track="lowVisTrack" id="added-lowVisTrack">
                            <img  src="./assets/svg/lvt.svg">
                          </a>
                          <a title="Off Track (HP)" href="#" class="button tiny radius secondary added-track-selector" data-track="offPiste" id="added-offPiste">
                            <img  src="assets/off-piste-added.png">
                          </a>
                          <a title="Small Track/Piste" href="#" class="button tiny radius secondary added-track-selector active" data-track="smallTrack" id="added-smallTrack">
                            <img  src="assets/small-track-added.png">
                          </a>
                          <a title="Track/Piste" href="#" class="button tiny radius secondary added-track-selector" data-track="track" id="added-track">
                            <img src="assets/track-added.png">
                          </a>
                          <a title="Tarmac Road" href="#" class="button tiny radius secondary added-track-selector" data-track="tarmacRoad" id="added-tarmacRoad">
                            <img src="assets/tarmac-road-added.png">
                          </a>
                          <a title="Dual Carriageway" href="#" class="button tiny radius secondary added-track-selector" data-track="dcw" id="added-dcw">
                            <img src="assets/dcw-added.png">
                          </a>
                        </div>
                      </li>
                      <li class="accordion-navigation">
                        <a href="#entry-track-tab" class='track-tab-title'>Enter on</a>
                        <div id="entry-track-tab" class="content">
                          <a title="Low visible track" href="#" class="button tiny radius secondary entry-track-selector" data-track="lowVisTrack">
                            <img  src="./assets/svg/lvt.svg">
                          </a>
                          <a title="Off Trach (HP)" href="#" class="button tiny radius secondary entry-track-selector" data-track="offPiste">
                            <img  src="assets/off-piste-entry.png">
                          </a>
                          <a title="Small Track/Piste" href="#" class="button tiny radius secondary entry-track-selector" data-track="smallTrack">
                            <img  src="assets/small-track-entry.png">
                          </a>
                          <a title="Track/Piste" href="#" class="button tiny radius secondary entry-track-selector" data-track="track">
                            <img src="assets/track-entry.png">
                          </a>
                          <a title="Tarmac Road" href="#" class="button tiny radius secondary entry-track-selector" data-track="tarmacRoad">
                            <img src="assets/tarmac-road-entry.png">
                          </a>
                          <a title="Dual Carriageway" href="#" class="button tiny radius secondary entry-track-selector" data-track="dcw">
                            <img src="assets/dcw-entry.png">
                          </a>
                        </div>
                      </li>
                      <li class="accordion-navigation">
                        <a href="#exit-track-tab" class='track-tab-title'>Exit on</a>
                        <div id="exit-track-tab" class="content">
                          <a title="Low visible track" href="#" class="button tiny radius secondary exit-track-selector" data-track="lowVisTrack">
                            <img  src="./assets/svg/lvt.svg">
                          </a>
                          <a title="Off Track (HP)" href="#" class="button tiny radius secondary exit-track-selector" data-track="offPiste">
                            <img  src="assets/off-piste-exit.png">
                          </a>
                          <a title="Small Track/Piste" href="#" class="button tiny radius secondary exit-track-selector" data-track="smallTrack">
                            <img  src="assets/small-track-exit.png">
                          </a>
                          <a title="Track/Piste" href="#" class="button tiny radius secondary exit-track-selector" data-track="track">
                            <img src="assets/track-exit.png">
                          </a>
                          <a title="Tarmac Road" href="#" class="button tiny radius secondary exit-track-selector" data-track="tarmacRoad">
                            <img src="assets/tarmac-road-exit.png">
                          </a>
                          <a title="Dual Carriageway" href="#" class="button tiny radius secondary exit-track-selector" data-track="dcw">
                            <img src="assets/dcw-exit.png">
                          </a>
                        </div>
                      </li>
                    </ul>
                  </div>
                  <div class="left large-4 columns">
                    <div class="text-selection hidden">
                      <div class="tl text-grid" data-top="30" data-left="30"><i class="fi-pencil"></i></div>
                      <div class="tm text-grid" data-top="30" data-left="85"><i class="fi-pencil"></i></div>
                      <div class="tr text-grid" data-top="30" data-left="145"><i class="fi-pencil"></i></div>

                      <div class="ml text-grid" data-top="95" data-left="30"><i class="fi-pencil"></i></div>
                      <div class="mm text-grid undo"><i class="fi-refresh"></i></div>
                      <div class="mr text-grid" data-top="95" data-left="145"><i class="fi-pencil"></i></div>

                      <div class="ll text-grid" data-top="140" data-left="30"><i class="fi-pencil"></i></div>
                      <div class="lm text-grid" data-top="140" data-left="85"><i class="fi-pencil"></i></div>
                      <div class="lr text-grid" data-top="140" data-left="145"><i class="fi-pencil"></i></div>
                    </div>
                    <div class="glyph-selection hidden">
                      <div class="tl glyph-grid" data-top="30" data-left="30"><i class="fi-plus"></i></div>
                      <div class="tm glyph-grid" data-top="30" data-left="85"><i class="fi-plus"></i></div>
                      <div class="tr glyph-grid" data-top="30" data-left="145"><i class="fi-plus"></i></div>

                      <div class="ml glyph-grid" data-top="95" data-left="30"><i class="fi-plus"></i></div>
                      <div class="mm glyph-grid undo"><i class="fi-refresh"></i></div>
                      <div class="mr glyph-grid" data-top="95" data-left="145"><i class="fi-plus"></i></div>

                      <div class="ll glyph-grid" data-top="140" data-left="30"><i class="fi-plus"></i></div>
                      <div class="lm glyph-grid" data-top="140" data-left="85"><i class="fi-plus"></i></div>
                      <div class="lr glyph-grid" data-top="140" data-left="145"><i class="fi-plus"></i></div>
                    </div>
                    <div class="track-selection">
                      <div class="tl track-grid" data-angle="-45"><div><i class="fi-arrow-up"></i></div></div>
                      <div class="tm track-grid" data-angle="0"><i class="fi-arrow-up"></i></div>
                      <div class="tr track-grid" data-angle="45"><div><i class="fi-arrow-up"></i></div></div>

                      <div class="ml track-grid" data-angle="-90"><i class="fi-arrow-left"></i></div>
                      <div class="mm track-grid undo"><i class="fi-refresh"></i></div>
                      <div class="mr track-grid" data-angle="90"><i class="fi-arrow-right"></i></div>

                      <div class="ll track-grid" data-angle="-135"><div><i class="fi-arrow-down"></i></div></div>
                      <div class="lm track-grid"data-angle="180"><i class="fi-arrow-down"></i></div>
                      <div class="lr track-grid" data-angle="135"><div><i class="fi-arrow-down"></i></div></div>
                    </div>
                  </div>
                  <div class="left large-4 columns note-tools">
                    <div data-bind="visible: isDrawing">
                      <div class="row">
                        <h5><span data-tooltip aria-haspopup="true" class="has-tip text-modifier" title="Select a text item to apply text sytles.">Drawing styles</span></h5>
                      </div>
                      <div class="row drawColorPick">
                        Line: <input type="color" data-bind="value: brushColor" />
                        Fill: <input type="color" data-bind="value: fillColor" />
                      </div>
                      <div class="row">
                        <input type="range" min="2" max="7" step="1" data-bind="value: brushWidth" />
                      </div>
                      <div class="row">
                        <input type="checkbox" data-bind="checked: isPathFilled"> Fill shape
                      </div>
                      <div class="row">
                        <div id="drawing-preset-wadi" class="drawing-preset ">Wadi</div>
                        <div id="drawing-preset-water" class="drawing-preset ">Water</div>
                        <div id="drawing-preset-sand" class="drawing-preset ">Sand</div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="left large-12 columns note-glyph-selection">
                        <span data-tooltip aria-haspopup="true" class="has-tip" title="Click to add glyphs to the the note.">
                          Insert glyph
                        </span>
                        <div class="note-grid" data-target="add" id="note-add-glyph"><i class="fi-plus"></i></i></div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="left large-12 columns note-text-insertion">
                        <span data-tooltip aria-haspopup="true" class="has-tip" title="Click to add text to the note.">
                          Insert text
                        </span>
                        <div class="note-grid" data-target="add" id="note-add-text"><i class="fi-plus"></i></i></div>
                      </div>
                    </div>
                    <div class="row">
                      <h5><span data-tooltip aria-haspopup="true" class="has-tip text-modifier" title="Select a text item to apply text sytles.">Text styles</span></h5>
                    </div>
                    <div class="row">
                          <span data-tooltip aria-haspopup="true" class="has-tip text-modifier" title="Make text Bold." id="text-modifier-normal">
                            Normal
                          </span>
                    </div>
                    <div class="row">
                          <span data-tooltip aria-haspopup="true" class="has-tip text-modifier" title="Make text Bold." id="text-modifier-bold">
                            Bold
                          </span>
                    </div>
                    <div class="row">
                          <span data-tooltip aria-haspopup="true" class="has-tip text-modifier" title="Make text Italic." id="text-modifier-italic">
                            Italic
                          </span>
                    </div>
                    <div class="row">
                          <span data-tooltip aria-haspopup="true" class="has-tip text-modifier" title="Make text Underline." id="text-modifier-underline">
                            Underline
                          </span>
                    </div>
                    <div class="row">
                          <span data-tooltip aria-haspopup="true" class="has-tip text-modifier" title="Make text Red." id="text-modifier-red">
                            Red
                          </span>
                    </div>
                    <div class="row">
                          <span data-tooltip aria-haspopup="true" class="has-tip text-modifier" title="Make text Green." id="text-modifier-green">
                            Green
                          </span>
                    </div>
                    <div class="row">
                          <span data-tooltip aria-haspopup="true" class="has-tip text-modifier" title="Make text Light Gray." id="text-modifier-lgray">
                            Light Gray
                          </span>
                    </div>
                    <div class="row">
                          <span data-tooltip aria-haspopup="true" class="has-tip text-modifier" title="Make text Cyan background." id="text-modifier-bgcyan">
                            Cyan background
                          </span>
                    </div>
                    <div class="row">
                          <span data-tooltip aria-haspopup="true" class="has-tip text-modifier" title="Make text Yellow background." id="text-modifier-bgyellow">
                            Yellow background
                          </span>
                    </div>
                    <div class="row" id="stop-time-options">
                        <h5 data-tooltip aria-haspopup="true" class="has-tip" title="Set stop time.">
                          Stop time</h5>
                        <div class="row collapse" id="stop-time-wrapper">
                          <div class="large-6 columns">
                            <span data-tooltip aria-haspopup="true" class="has-tip prefix" title="Stop time.">
                              Time(s):
                            </span>
                          </div>
                          <div class="large-6 columns">
                            <input type="number" id="stop-time">
                          </div>
                        </div>
                    </div>
                    
                    <div class="row hidden" id="notification-options"  >
                      <div class="left large-12 columns">
                        <span data-tooltip aria-haspopup="true" class="has-tip" title="Change the waypoint open and validation radius.">
                          Waypoint options
                        </span>
                        <br>
                        <div>
                          <div class="row collapse" id="notification-open-radius-wrapper">
                            <div class="large-6 columns">
                              <span data-tooltip aria-haspopup="true" class="has-tip prefix" title="Waypoint open radius.">
                                Open(m):
                              </span>
                            </div>
                            <div class="large-6 columns">
                              <input type="number" id="notification-open-radius" min="10" max="2000" step="10">
                            </div>
                          </div>
                          <div class="row collapse">
                            <div class="large-6 columns">
                              <span data-tooltip aria-haspopup="true" class="has-tip prefix" title="Waypoint validation radius.">
                                Validation:
                              </span>
                            </div>
                            <div class="large-6 columns">
                              <input type="number" id="notification-validation-radius" min="5" max="2000" step="5">
                            </div>
                          </div>
                          <div class="row collapse" id="notification-time-wrapper">
                            <div class="large-6 columns">
                              <span data-tooltip aria-haspopup="true" class="has-tip prefix" title="Time limit.">
                                Time(s):
                              </span>
                            </div>
                            <div class="large-6 columns">
                              <input type="number" id="notification-time">
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--  END CONTENT -->
    </main>
  </body>
  <!--
    Define templates
  -->
  <!--  instruction template-->
  <script type="text/html" id="waypoint-template">
    <div class='waypoint row' data-bind="css: assignInstructionColoring()">
      <div class="waypoint-distance" data-bind="css: assignWaypointColoring()">
        <div class='total-distance'>
          <div data-bind="text: filteredKmFromStart, css: { 'waypoint-danger-2': waypointDanger2(), 'total-distance-100m':filteredKmFromStart().length > 5 }"></div>
          <div class="reset-zeroes" data-bind="visible: hasResetGlyph()">0.00</div>
        </div>
        <div class="waypoint-icon" data-bind="html: waypointIcon(), css: { 'waypoint-icon-none': waypointIcon() == undefined }">
        </div>
        <div class="relative-distance">
          <div data-bind="text: distFromPrev">
          </div>
        </div>
        <div class="instruction-number">
          <div data-bind="text: instructionNumber()">
          </div>
        </div>
      </div>
      <div class='waypoint-tulip' data-bind="css: assignTulipColoring()">
        <canvas data-bind="instructionCanvasRendered" width='180' height='180'>
        </canvas>
        <div class="tulip-checkpoint-number" data-bind="text: checkpointNumber(), visible: checkpointNumber()"></div>
      </div>
      <div class='waypoint-note'>
        <canvas data-bind="noteCanvasRendered" width='180' height='180'>
        </canvas>
        <div class='heading' data-bind="css: { 'heading-coordinates-hidden': !showHeading()}, text: heading">
        </div>
        <div class="coordinates" data-bind="css: { 'heading-coordinates-hidden': !showCoordinates()}">
          <span data-bind="html: coordinates"></span>
        </div>
        <div class="waypoint-number" data-bind="css: { 'waypoint-number-hidden': !waypointNumber(), 'waypoint-number-coord':showCoordinates()}, text:waypointNumber()">
        </div>
      </div>
    </div>
  </script>
  <!--
    Glyph Modal
  -->
  <div id="glyphs" class="reveal-modal glyph-modal" data-reveal aria-hidden="true" role="dialog">
    <h3>Choose from the options below to place a glyph: <a class="close-reveal-modal" aria-label="Close">&#215;</a></h3>
    <hr>
    <input id="glyph-search" placeholder="Search for a gylph"></input>
    <i class="fi-x" id="glyph-search-clear"></i>
    <ul id="glyph-search-results" class="small-block-grid-5">
    </ul>
    <div id="glyph-content"></div>
    
  </div>
  <!-- Show about modal -->
  <div id="about" class="reveal-modal glyph-modal" data-reveal aria-hidden="true" role="dialog">
    <img src="assets/tulip-logo.png" width="100px" style="float: right;">
    <h1>Tulip</h1><a class="close-reveal-modal" aria-label="Close">&#215;</a>
    <div>Version: <div id="about-version">0.0.0</div></div>
    <h3>Credits</h3>
    <div>Original project by Drew Mitchell, Luke Bennett and Dave Peckham</jamesandrewmitchell>
      <a href=" https://github.com/storm-factory/tulip" target="_blank" rel="noreferrer"> https://github.com/storm-factory/tulip</a>
    </div>
    <p>
      <div>Fork maintained by Ilias Daradimos on <a href="https://gitlab.com/drid/tulip" target="_blank" rel="noreferrer">https://gitlab.com/drid/tulip</a>
    <h3>License</h3>
    <a href="https://www.gnu.org/licenses/old-licenses/gpl-2.0.en.html" target="_blank" rel="noreferrer">GNU General Public License, version 2</a>
    
    <h3>Attributions</h3>
    <div id="attributions">
      <em>Loading attributions...</em>
    </div>
    
    </div>
  </div>

  <!-- <script>
    //Jquery sees it is running in CommonJS env, and wants to be used as such.
    window.$ = window.jQuery = require('./assets/libs/jquery-2.1.4.min.js');
  </script> -->
  <script src="node_modules/jquery/dist/jquery.min.js"></script>
  <!--
    Load the rest of our libraries
  -->
  <script src="assets/libs/jsclass/dist/browser/js.class.min.js"></script>
  <script src="node_modules/knockout/build/output/knockout-latest.js"></script>
  <script src='assets/libs/fabric.min.js'></script>
  <script src='assets/libs/simplify.js'></script>
  <script src='node_modules/quill/dist/quill.js'></script>
  <script src='node_modules/foundation-sites/js/foundation.min.js'></script>
  <script src='node_modules/foundation-sites/js/foundation/foundation.tooltip.js'></script>
  <script src='node_modules/foundation-sites/js/vendor/modernizr.js'></script>
  <!--
    Load the application
  -->
  <script src='src/application.js'></script>
  <script src="src/load-credits.js"></script>
  <!--
    Load Modules
  -->
  <script src='src/modules/map-viewport-optimizer.js'></script>
  <script src='src/modules/track-editors.js'></script>
  <script src='src/modules/io.js'></script>
  <!--
    Load Controllers
  -->
  <script src='src/controllers/map-controller.js'></script>
  <script src='src/controllers/roadbook-controller.js'></script>
  <script src='src/modules/glyph-controls.js'></script>
  <script src='src/modules/note-controls.js'></script>
  <!--
    Load Models
  -->
  <script src='src/modules/text-element.js'></script>
  <script src='src/models/map-model.js'></script>
  <script src='src/models/roadbook-model.js'></script>
  <script src='src/modules/tracks.js'></script>
  <script src='src/modules/tulip.js'></script>
  <script src='src/modules/note.js'></script>
  <script src='src/modules/notification.js'></script>
  <script src='src/modules/instruction.js'></script>  
  <script>
    fabric.TextElement = TextElement;
    fabric.TextElement.fromObject = function (object, callback) {
      const instance = new fabric.TextElement(object.text, object);
      if (callback) {
        callback(instance);
      }
      return instance;    };
  /*
    ---------------------------------------------------------------------------
    Instantiate the application
    ---------------------------------------------------------------------------
  */
    app = new App();

    $(document).ready(function(){
      ko.applyBindings(app.roadbook);
      $(document).foundation();
      $('#about-version').text(app.version)
      function setMapSize(){
        var width = window.innerWidth;
        var height = window.innerHeight;
        var hypotenuse = Math.sqrt(Math.pow(width,2)+Math.pow(height,2));

        $('#map').css('height', hypotenuse);
        $('#map').css('width', hypotenuse);
        $('#map').css('left', (width/2)-(hypotenuse/2));
        $('#map').css('top', (height/2)-(hypotenuse/2));
      }
      setMapSize();
      $(window).resize(function(){
        setMapSize();
      })
    });

    app.initializeGoogleMaps();
  </script>

</html>
